<html>
    <head>
        <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.png') }}">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script>
            function makeWhatsappPreview(input) {
                result = input.replaceAll("\n", "<br>");
                result = result.replaceAll(/\*(\S.+?)\*/g,"<b>$1</b>");
                return result;
            }

            function showPreview() {
//                document.getElementById("orig_heb_panel").style.width="1%";
                document.getElementById("orig_heb_panel").style.display="none";
                document.getElementById("translation_panel").style.width="48%";
                document.getElementById("preview_panel").style.width="50%";
                document.getElementById("preview_panel").style.display="initial";
                document.getElementById("preview_panel").innerHTML=makeWhatsappPreview(document.getElementById("translated_text").value);
                document.getElementById("preview_button").textContent="Hide Preview";
                document.getElementById("preview_button").setAttribute("onclick","javascript: hidePreview();");
            }

            function hidePreview() {
//                document.getElementById("preview_panel").style.width="1%";
                document.getElementById("preview_panel").style.display="none";
                document.getElementById("preview_panel").innerHTML="";
                document.getElementById("orig_heb_panel").style.width="40%";
                document.getElementById("orig_heb_panel").style.display="initial";
                document.getElementById("translation_panel").style.width="58%";
                document.getElementById("preview_button").textContent="Preview";
                document.getElementById("preview_button").setAttribute("onclick","javascript: showPreview();");
            }

            function copyToClipboard() {
                navigator.clipboard.writeText(document.getElementById('translated_text').value);
            }

            function deleteDraft(dt) {
                params = window.location.search;
                if (params != null) {
                    draft_id = params.substring(4);
                    if (draft_id==null || draft_id=="") {
                        draft_id = "{{draft_timestamp}}";
                    }
                    $.ajax({
                        url: "/deleteDraft?dt="+draft_id,
                        type: 'GET',
                        success: function(res) {
                            console.log(res);
                        }
                    });                                    
                }
            }
        </script>        
    </head>

    <body>
        <table width="100%" border="0" cellspacing="10">
            <tr>
                <td width="40%" valign="top" id="orig_heb_panel">
                    <textarea rows="40" style="width:100%; font-size:17px;" dir="rtl">
                    {{heb_text}}
                    </textarea>
                </td>
                <td width="58%" valign="top" id="translation_panel">
                    <textarea id="translated_text" rows="50" style="width:100%; font-size:14px;" spellcheck="true">
ðŸ“» *Israel News Highlights*
*{{date_info.part_of_day}} Edition, {{date_info.day_of_week}}, {{date_info.hebrew_dom}} {{date_info.hebrew_month}}, {{date_info.hebrew_year}}, {{date_info.secular_month}} {{date_info.secular_dom}}*
                    
  â€¢   â€¢   â€¢
                    
&#128204; *Swords of Iron - Day {{date_info.day_of_war}}*                 
         
{% for section in sections %}
{% if section in organized and organized[section] | length > 0 %}
{% if section in ['SOUTH','NORTH','YandS']%}*{%else%}ðŸ“Œ{%endif%} *{{sections[section]}}:*
{% for line in organized[section] %}
{{line}}
{% endfor %}{% endif %}
{% endfor %}

 â€¢   â€¢   â€¢

To donate and support our News in Brief initiatives:
https://www.charidy.com/lokchim

 â€¢   â€¢   â€¢

 Thatâ€™s all for Israel News Highlights this {{date_info.part_of_day}}.
From Lokhim Ahrayut
To join the news group: ðŸ‘‡
https://link.mmb.org.il/INH_NEWS

</textarea>            
<br><br>
<table width="100%" border="0">
    <tr>
        <td><button id="restart_button" style="font-size: 20px; padding:8px 8px" onclick="window.location='/'">Start Again</button></td>
        <td align="center"><button id="preview_button" style="font-size: 20px; padding:8px 8px" onclick="showPreview();">Preview</button></td>
        <td align="right"><button style="font-size: 20px; padding:8px 8px" onclick="copyToClipboard();deleteDraft();">Copy to Clipboard</button>
        (<i>and remove draft</i>)</td>

    </tr>
</table>

                </td>
            <td width="1%" valign="top" id="preview_panel">

            </td>
            </tr>
    </table>

        <!--
<br><br><br><br><br><br>
<br>------RAW GOOGLE TRANSLATION--------------------<br>

{{translated}}
<br>------------------------------------------------<br>
{{translated_lines}}
-->
    </body>
</html>
